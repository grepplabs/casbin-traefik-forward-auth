apiVersion: kind.x-k8s.io/v1alpha4
kind: Cluster
nodes:
  - role: control-plane
    image: kindest/node:v1.33.4@sha256:25a6018e48dfcaee478f4a59af81157a437f15e6e140bf103f85a2e7cd0cbbf2
    kubeadmConfigPatches:
      - |
        kind: InitConfiguration
        nodeRegistration:
          kubeletExtraArgs:
            node-labels: "ingress-ready=true"
    extraPortMappings:
      # traefik web - curl -H 'Host: echo.local' http://localhost:30080/get
      - containerPort: 30080
        hostPort: 30080
        listenAddress: "127.0.0.1"
      # ingress-nginx curl http://echo.127.0.0.1.nip.io:30180/get
      - containerPort: 30180
        hostPort: 30180
        listenAddress: "127.0.0.1"
